var qwertyGrammar;(()=>{"use strict";var e={m:{},d:(n,t)=>{for(var i in t)e.o(t,i)&&!e.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},u:e=>e+".bundle.js"};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var n;e.g.importScripts&&(n=e.g.location+"");var t=e.g.document;if(!n&&t&&(t.currentScript&&(n=t.currentScript.src),!n)){var i=t.getElementsByTagName("script");i.length&&(n=i[i.length-1].src)}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=n})(),e.b=document.baseURI||self.location.href;var n={};e.r(n),e.d(n,{magic:()=>s});const t='<style>\n        body{\n            margin: 0;\n            padding: 0;\n        }\n        \n   \n        .rules{\n            display: flex;\n            flex-direction: column;\n        }\n        .ruleBlock{\n            display: flex;\n            align-items: center;\n            font-family: Calibri;\n            margin-top: 10px;\n        }\n        .term_input{\n            width: 25px;\n            height: 25px;\n            margin-right: 10px;\n            padding: 5px;\n            font-size: 20px;\n            text-align: center;\n        }\n        .noterm_input{\n            height: 25px;\n            padding: 5px;\n            font-size: 16px;\n            margin-left: 10px;\n        }\n        .add_ruleBlock{\n            width: 30px;\n            height: 30px;\n            border-radius: 100%;\n            border: 1px solid black;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            background-color: greenyellow;\n            font-size: 20px;\n            padding: 0px;\n            cursor: pointer;\n            margin-top: 10px;\n            margin-left: 3px;\n            margin-bottom: 10px;\n        }\n          .compare{\n            margin-top: 30px;\n            padding: 7px 10px;\n            background-color: greenyellow;\n            position: fixed;\n            bottom: 30px;\n            right: 30px;\n            /*z-index: -1;*/\n            cursor: pointer;\n            border-radius: 6px;\n            font-size: 16px;\n            \n        }\n        .side{\n            width: 100%;\n            margin-left: 10px;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n        }\n     \n        .layout{\n            display: flex;\n        }\n        .del{\n            width: 15px;\n            height: 15px;\n            background-color: orangered;\n            padding: 5px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            border-radius: 100%;\n            margin-left: 10px;\n            cursor: pointer;\n        }\n        .overflowHidden{\n            overflow: hidden;\n        }\n        .loading{\n            width: 100%;\n            height: 100%;\n            position: fixed;\n        }\n      \n\n        .loading .reset{\n            position: absolute;\n            right: 10px;\n            top: 10px;\n            font-size: 20px;\n            cursor: pointer;\n        }\n        .loading .layout{\n            font-family: "Calibri Light";\n            background: white;\n            max-width: 700px;\n            width: 100%;\n            position: fixed;\n            transform: translate(-50%, -50%);\n            left: 50%;\n            top: 50%;\n            height: 500px;\n            border: 1px solid black;\n            opacity: 1;\n            z-index: 10;\n        }\n\n        .loading .dark{\n            position: absolute;\n            top: 0;\n            left: 0;\n            height: 100vh;\n            width: 100vw;\n            background: #000;\n            opacity: 0.3;\n            z-index: 9;\n        }\n\n        .loading_step{\n            height: 100%;\n            width: 100%;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            flex-direction: column;\n            text-align: center;\n\n            font-weight: bold;\n        }\n        .loading_step div{\n            transition: opacity 0.3s ease-in;\n            opacity: 0;\n            font-size: 30px;\n        }\n        .loading_step .done{\n            transition: opacity 0.3s ease-in;\n            opacity: 1;\n            color: black;\n        }\n\n        .result{\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            transition: opacity 0.3s ease-in;\n            font-size: 40px;\n            text-align: center;\n        }\n\n        .opacityHidden{\n            opacity: 0;\n            transition: opacity 0.3s ease-in;\n        }\n\n        .hide{\n            display: none !important;\n        }\n        \n        .genFiend{\n            border: 2px solid yellowgreen;\n            max-width: 800px;\n            height: 300px;\n            width: 100%;\n            padding: 10px;\n            margin-bottom: 30px;\n            border-radius: 5px;\n        }\n        \n        .genFiend:disabled{\n            color: black;\n        }\n\n        .loader{\n            position: absolute;\n            left: 50%;\n            transform: translateX(-50%);\n            bottom: 20px;\n        }\n\n        .lds-roller {\n            display: inline-block;\n            position: relative;\n            width: 80px;\n            height: 80px;\n        }\n        .lds-roller div {\n            animation: lds-roller 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n            transform-origin: 40px 40px;\n        }\n        .lds-roller div:after {\n            content: " ";\n            display: block;\n            position: absolute;\n            width: 7px;\n            height: 7px;\n            border-radius: 50%;\n            background: yellowgreen;\n            /*background: #cef;*/\n            margin: -4px 0 0 -4px;\n        }\n        .lds-roller div:nth-child(1) {\n            animation-delay: -0.036s;\n        }\n        .lds-roller div:nth-child(1):after {\n            top: 63px;\n            left: 63px;\n        }\n        .lds-roller div:nth-child(2) {\n            animation-delay: -0.072s;\n        }\n        .lds-roller div:nth-child(2):after {\n            top: 68px;\n            left: 56px;\n        }\n        .lds-roller div:nth-child(3) {\n            animation-delay: -0.108s;\n        }\n        .lds-roller div:nth-child(3):after {\n            top: 71px;\n            left: 48px;\n        }\n        .lds-roller div:nth-child(4) {\n            animation-delay: -0.144s;\n        }\n        .lds-roller div:nth-child(4):after {\n            top: 72px;\n            left: 40px;\n        }\n        .lds-roller div:nth-child(5) {\n            animation-delay: -0.18s;\n        }\n        .lds-roller div:nth-child(5):after {\n            top: 71px;\n            left: 32px;\n        }\n        .lds-roller div:nth-child(6) {\n            animation-delay: -0.216s;\n        }\n        .lds-roller div:nth-child(6):after {\n            top: 68px;\n            left: 24px;\n        }\n        .lds-roller div:nth-child(7) {\n            animation-delay: -0.252s;\n        }\n        .lds-roller div:nth-child(7):after {\n            top: 63px;\n            left: 17px;\n        }\n        .lds-roller div:nth-child(8) {\n            animation-delay: -0.288s;\n        }\n        .lds-roller div:nth-child(8):after {\n            top: 56px;\n            left: 12px;\n        }\n        @keyframes lds-roller {\n            0% {\n                transform: rotate(0deg);\n            }\n            100% {\n                transform: rotate(360deg);\n            }\n        }\n    </style>\n';class i{constructor({id:e}){this.step=-1,this.steps=["Генерируем слова 1/2","Генерируем слова 2/2","Сопоставляем","Смотрим принадлежность грамматикам 1/2","Сопоставляем","Смотрим принадлежность грамматикам 2/2"],this.id=e,this.element=document.querySelector("#"+e),this.resetBtn=this.element.querySelector(".reset"),this.darkArea=this.element.querySelector(".dark"),this.loader=this.element.querySelector(".lds-roller"),this.loadingStep=this.element.querySelector(".layout").querySelector(".loading_step"),this.resultField=this.element.querySelector(".layout").querySelector(".result"),this.resetBtn.onclick=e=>this.reset(),this.darkArea.onclick=e=>this.reset()}next(){document.body.classList.add("overflowHidden"),this.element.classList.remove("hide"),this.step+=1,this.loadingStep.children[5-this.step].classList.add("done"),"function"==typeof this.onNextObserver&&this.onNextObserver()}final({check1:e,check2:n}){this.loader.classList.add("hide"),this.resultField.innerHTML=`${e} | ${n}`,this.loadingStep.classList.add("opacityHidden"),setTimeout((()=>{this.resultField.classList.remove("opacityHidden")}),200)}error(e){document.body.classList.add("overflowHidden"),this.element.classList.remove("hide"),this.loader.classList.add("hide"),this.resultField.innerHTML=`${e}`,this.loadingStep.classList.add("opacityHidden"),setTimeout((()=>{this.resultField.classList.remove("opacityHidden")}),200)}reset(){this.resultField.innerHTML="",this.resultField.classList.add("opacityHidden"),this.loader.classList.remove("hide"),this.step=-1;for(let e=0;e<this.loadingStep.children.length;e++)this.loadingStep.children[e].classList.remove("done");this.loadingStep.classList.remove("opacityHidden"),this.element.classList.add("hide"),"function"==typeof this.onCloseObserver&&this.onCloseObserver(),document.body.classList.remove("overflowHidden")}setOnCloseObserver(e){this.onCloseObserver=e}setOnNextObserver(e){this.onNextObserver=e}}class r{constructor(e){this.grammar=e}setWorker(n){const t=new Worker(new URL(e.p+e.u(29),e.b));return t.onmessage=({data:{message:e,payload:t}})=>{switch(e){case"NEXT":n.next();break;case"FINAL":n.final(t);break;case"GEN_1":document.querySelector(".textarea_1").value=t.map((e=>e+"\t")).join("");break;case"GEN_2":break;case"ERROR":n.error(t)}},t.onerror=e=>{alert("Что-то пошло не так")},t}saveGrammars({grammar1:e,grammar2:n}){localStorage.setItem("grammars",JSON.stringify({grammar1:e,grammar2:n}))}getGrammars(){let e=[],n=this.grammar;return document.querySelectorAll(".rules")[0].querySelectorAll(".ruleBlock").forEach((n=>{e.push({sign:n.children[0].value,res:n.children[2].value})})),console.warn("ГРАММАТИКА\n",JSON.stringify({grammar:e})),{grammar1:e,grammar2:n}}start(){let e=new i({id:"loading"});document.querySelector("#genFiend").value="";const n=()=>{document.querySelectorAll(".term_input").forEach((e=>{e.onkeypress=e=>{e.preventDefault(),/[a-z|A-Z]/.test(e.key)&&(e.target.value=e.key.toUpperCase())},e.onpaste=e=>{e.preventDefault();let n=(event.clipboardData||window.clipboardData).getData("text")[0].toUpperCase();/[a-z|A-Z]/.test(n)&&(e.target.value=n)},e.onblur=e=>this.saveGrammars(this.getGrammars())})),document.querySelectorAll(".noterm_input").forEach((e=>{e.onblur=e=>this.saveGrammars(this.getGrammars()),e.onkeypress=e=>{/[А-Яа-я~]/g.test(e.key)&&e.preventDefault()},e.onpaste=e=>{let n=(event.clipboardData||window.clipboardData).getData("text");/[А-Яа-я]/g.test(n)&&e.preventDefault()}})),document.querySelectorAll(".del").forEach((e=>{e.onclick=e=>{e.target.parentNode.remove(),this.saveGrammars(this.getGrammars())}}))};function r(e,n,t){return`<div class="ruleBlock">\n            <input type="text" class="term_input" value="${e||""}" ${t?"disabled":""}>\n            <span>=></span>\n            <input type="text" class="noterm_input" value="${n||""}">\n            ${t?"":'<div class="del">D</div>'}\n        </div>`}document.querySelectorAll(".add_ruleBlock").forEach((e=>{e.onclick=t=>{document.querySelector(`.rules.rules${e.dataset.type}`).insertAdjacentHTML("beforeend",r()),n(),this.saveGrammars(this.getGrammars())}})),document.querySelector(".compare").onclick=function(n){const t=this.setWorker(e);e.setOnCloseObserver((()=>{t.terminate(),n.target.classList.remove("hide")})),e.setOnNextObserver((()=>{n.target.classList.add("hide")}));let{grammar1:i,grammar2:r}=this.getGrammars();t.postMessage({message:"start",payload:{grammar1:i,grammar2:r}})}.bind(this),function({grammar1:e,grammar2:n}){let t=e.map(((e,n)=>r(e.sign,e.res,"S"===e.sign&&0===n))).join("");t&&document.querySelector(".rules.rules1").insertAdjacentHTML("beforeend",t)}(JSON.parse(localStorage.getItem("grammars"))||{grammar1:[{sign:"S",res:""}],grammar2:[{sign:"S",res:""}]}),n(),document.head.insertAdjacentHTML("beforeend",t)}}class a{constructor(){this.divId="grammar",this.state={},this.grammar=null}init(e,n,t,...i){this.divId=e,this.config=t,this.grammar=this.config.grammar,document.head.insertAdjacentHTML("beforeend",this.getCSS()),document.querySelector("#"+this.divId).innerHTML=this.getLayout();const a=new r(this.grammar);this.userInterface=a,a.start()}reset(){}solution(){if(this.userInterface)return this.userInterface.getGrammars()}load(e){}getLayout(){return'\n<div id="root">\n    <div class="loading hide" id="loading">\n        <div class="dark"></div>\n        <div class="layout">\n            <div class="loader">\n                <div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>\n            </div>\n\n            <div class="loading_step">\n                <div>Смотрим принадлежность грамматикам 2/2</div>\n                <div>Сопоставляем</div>\n                <div>Смотрим принадлежность грамматикам 1/2</div>\n                <div>Сопоставляем</div>\n                <div>Генерируем слова 2/2</div>\n                <div>Генерируем слова 1/2</div>\n            </div>\n            <div class="result opacityHidden">\n\n            </div>\n            <div class="reset">x</div>\n        </div>\n    </div>\n    <div class="layout">\n        <div class="side">\n            <div class="rules rules1">\n\x3c!--                <div class="ruleBlock">--\x3e\n\x3c!--                    <input type="text" class="term_input" value="S" disabled>--\x3e\n\x3c!--                    <span>=></span>--\x3e\n\x3c!--                    <input type="text" class="noterm_input">--\x3e\n\x3c!--                </div>--\x3e\n            </div>\n            <div class="add_ruleBlock" data-type="1">+</div>\n            <textarea name="" cols="30" rows="10" class="textarea_1 genFiend" id="genFiend" disabled>\n\n            </textarea>\n        </div>\n    </div>\n    <button class="compare">сравнить</button>\n</div>\n'}getCSS(){return t}}function s(){return new a}qwertyGrammar=n})();